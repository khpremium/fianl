<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="mypage">

	<select id="profile" parameterType="string" resultType="mypage.ClientDTO">
		select * from client where id = #{id}
	</select>

	<select id="reservation" parameterType="String" resultType="mypage.ReservationDTO">
		SELECT r.*,a.*,c.*,t.city_name from reservation r, airinfo a, client c, city t
where r.AIRINFO_FLIGHT=a.flight and r.user_id=c.ID and t.city_code = a.city_code_dep and r.user_id = #{id} order by rv_num desc
	</select>

	<select id="passport" parameterType="string" resultType="Integer">
		select p_count from reservation
			where rv_code=#{rv_code} and rownum=1
	</select>	
	
	
	<delete id="reservationdel" parameterType="String" >
		delete from reservation where rv_code=#{rv_code}
	</delete>
	
	<insert id="passportIns" parameterType="mypage.MypassportDTO">
	INSERT INTO PASSPORT(NAME_KR,NAME_EN,GENDER,P_BIRTH,PASSPORT_NUM,EXP_DATE,PHONENUM,P_COUNTRY,RESERVATION_RV_CODE)
    VALUES(#{name_kr},#{name_en},#{gender},#{p_birth},#{passport_num},#{exp_date},#{phonenum},#{p_country},#{reservation_rv_code})
	</insert>
	
	<delete id="passportdel" parameterType="String" >
		delete from passport where reservation_rv_code=#{reservation_rv_code}
	</delete>
	
	<select id="passportSearch" parameterType="String" resultType="mypage.MypassportDTO">
	 	select * from passport where reservation_rv_code=#{reservation_rv_code}
	</select>
	
	<update id="proupdate">
		update client set pass=#{pass},phonenum=#{phonenum},email=#{email} where id=#{id}
	</update>
	
	<delete id="prodelete">
		delete from client where id=#{id}
	</delete>
	
	<select id="count" resultType="int">
		select count(*) from board where B_CATEGORY_C_NUM=0
	</select>
	
	<select id="list" parameterType="mypage.PagingDTO" resultType="mypage.MyBoardDTO">
	select * from board where B_CATEGORY_C_NUM=0
	</select>
	
	
	
</mapper>